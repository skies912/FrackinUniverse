require "/scripts/vec2.lua"
require "/scripts/util.lua"
require "/scripts/status.lua"
require "/scripts/activeitem/stances.lua"
require "/custom/Util.lua"

function init()
	self.form = 0

	self.doubleShiftTimer 	= 0
	self.prevShift 			= false
	self.prevPrimary		= false
	self.prevAlt			= false

	self.baseOffset 		= {-0.0625, -0.0625}
	self.offsets 			= {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
	self.destOffsets 		= {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
	self.rotOffsets 		= {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
	self.destRotOffsets 	= {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
	self.rotations 			= {0, 0, 0, 0}
	self.destRotations 		= {0, 0, 0, 0}
	self.tweenTimes 		= {8, 8, 8, 8}
	self.hide               = {false, false, false}
	
	self.allRotation 		= 0
	self.destAllRotation 	= 0
	self.allRotationTween 	= 8

	self.allOffset 		= {-1, 0}
	self.destAllOffset 	= {-1, 0}
	self.allOffsetTween	= 8

	self.armAngleOffset 		= 0
	self.destArmAngleOffset 	= 0
	self.armAngleOffsetTween 	= 6

	self.transformSpeed = 1
	self.noOfForms = 1

	self.primaryCooldown 	= 0
	self.secondaryCooldown 	= 0
	self.tertaryCooldown 	= 0

	self.flashTimer = 0
	self.flashOn 	= false

	self.chargeLevel 	= 0
	self.chargeTime 	= 0
	self.aimAngle 		= 0
	self.aimDirection 	= 0
	self.crouchoffset 	= 0

	self.defaultPoly = mcontroller.baseParameters().standingPoly
	self.mechPoly = {{-1, -4.125}, {-3, -2.125}, {-3, 1.5}, {-1, 2.5}, {1, 2.5}, {3, 1.5}, {3, -2.125}, {1, -4.125}}
	self.mechCrouchPoly = {{-1, -3.125}, {-3, -2.125}, {-3, 0.5}, {-1, 1.5}, {1, 1.5}, {3, 0.5}, {3, -2.125}, {1, -3.125}}

	self.legCycle = 0
	self.puffTimer = 0
	self.prevControls = nil

	self.isTwoHanded = config.getParameter("twoHanded")

	if self.isTwoHanded then
		activeItem.setInventoryIcon("/celestial/stars/star21pxRed.png:2?hueshift=60")
	else
		activeItem.setInventoryIcon("/celestial/stars/star11pxRed.png:2?hueshift=60")
	end
	animator.playSound("equip")

	updateAim()

	animator.setGlobalTag("bodySprite", "?setcolor=ffffff?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=2?crop=0;0;48;48?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=00000000;03000201=00000000;03000301=00000000;03000401=00000000;03000501=00000000;03000601=00000000;03000701=00000000;03000801=00000000;04000101=00000000;04000201=00000000;04000301=00000000;04000401=00000000;04000501=00000000;04000601=00000000;04000701=00000000;04000801=00000000;05000101=00000000;05000201=00000000;05000301=00000000;05000401=00000000;05000501=00000000;05000601=00000000;05000701=00000000;05000801=00000000;06000101=00000000;06000201=00000000;06000301=00000000;06000401=00000000;06000501=00000000;06000601=00000000;06000701=00000000;06000801=00000000;07000101=00000000;07000201=00000000;07000301=00000000;07000401=00000000;07000501=00000000;07000601=00000000;07000701=00000000;07000801=00000000;08000101=00000000;08000201=00000000;08000301=00000000;08000401=00000000;08000501=00000000;08000601=00000000;08000701=00000000;08000801=000000ff;09000101=00000000;09000201=00000000;09000301=00000000;09000401=00000000;09000501=00000000;09000601=00000000;09000701=000000ff;09000801=000000ff;10000101=00000000;10000201=00000000;10000301=00000000;10000401=00000000;10000501=00000000;10000601=000000ff;10000701=000000ff;10000801=000000ff;11000101=00000000;11000201=00000000;11000301=00000000;11000401=00000000;11000501=00000000;11000601=000000ff;11000701=404040ff;11000801=000000ff;12000101=00000000;12000201=00000000;12000301=00000000;12000401=00000000;12000501=000000ff;12000601=202020ff;12000701=202020ff;12000801=404040ff;13000101=00000000;13000201=00000000;13000301=00000000;13000401=000000ff;13000501=202020ff;13000601=202020ff;13000701=202020ff;13000801=202020ff;14000101=00000000;14000201=00000000;14000301=00000000;14000401=000000ff;14000501=000000ff;14000601=202020ff;14000701=202020ff;14000801=202020ff;15000101=00000000;15000201=00000000;15000301=000000ff;15000401=000000ff;15000501=000000ff;15000601=202020ff;15000701=202020ff;15000801=202020ff;16000101=00000000;16000201=00000000;16000301=000000ff;16000401=000000ff;16000501=000000ff;16000601=202020ff;16000701=202020ff;16000801=202020ff;17000101=00000000;17000201=00000000;17000301=000000ff;17000401=000000ff;17000501=000000ff;17000601=000000ff;17000701=202020ff;17000801=202020ff;18000101=00000000;18000201=000000ff;18000301=202020ff;18000401=202020ff;18000501=404040ff;18000601=000000ff;18000701=000000ff;18000801=202020ff;19000101=00000000;19000201=000000ff;19000301=202020ff;19000401=202020ff;19000501=202020ff;19000601=404040ff;19000701=404040ff;19000801=000000ff;20000101=00000000;20000201=000000ff;20000301=000000ff;20000401=202020ff;20000501=202020ff;20000601=202020ff;20000701=404040ff;20000801=000000ff;21000101=00000000;21000201=000000ff;21000301=000000ff;21000401=202020ff;21000501=202020ff;21000601=202020ff;21000701=404040ff;21000801=000000ff;22000101=00000000;22000201=000000ff;22000301=000000ff;22000401=202020ff;22000501=202020ff;22000601=202020ff;22000701=404040ff;22000801=000000ff;23000101=000000ff;23000201=000000ff;23000301=000000ff;23000401=000000ff;23000501=202020ff;23000601=202020ff;23000701=000000ff;23000801=000000ff;24000101=000000ff;24000201=000000ff;24000301=000000ff;24000401=000000ff;24000501=000000ff;24000601=202020ff;24000701=000000ff;24000801=000000ff;25000101=000000ff;25000201=000000ff;25000301=202020ff;25000401=404040ff;25000501=000000ff;25000601=000000ff;25000701=000000ff;25000801=000000ff;26000101=000000ff;26000201=000000ff;26000301=202020ff;26000401=202020ff;26000501=404040ff;26000601=404040ff;26000701=000000ff;26000801=000000ff;27000101=00000000;27000201=000000ff;27000301=000000ff;27000401=202020ff;27000501=202020ff;27000601=404040ff;27000701=000000ff;27000801=000000ff;28000101=00000000;28000201=000000ff;28000301=000000ff;28000401=202020ff;28000501=202020ff;28000601=202020ff;28000701=404040ff;28000801=000000ff;29000101=00000000;29000201=000000ff;29000301=000000ff;29000401=000000ff;29000501=202020ff;29000601=202020ff;29000701=404040ff;29000801=000000ff;30000101=00000000;30000201=000000ff;30000301=000000ff;30000401=000000ff;30000501=202020ff;30000601=202020ff;30000701=202020ff;30000801=000000ff;31000101=00000000;31000201=000000ff;31000301=000000ff;31000401=000000ff;31000501=202020ff;31000601=000000ff;31000701=000000ff;31000801=000000ff;32000101=00000000;32000201=00000000;32000301=000000ff;32000401=000000ff;32000501=000000ff;32000601=202020ff;32000701=404040ff;32000801=404040ff?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-8?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=00000000;03000201=00000000;03000301=00000000;03000401=00000000;03000501=00000000;03000601=00000000;03000701=000000ff;03000801=000000ff;04000101=00000000;04000201=00000000;04000301=00000000;04000401=00000000;04000501=000000ff;04000601=000000ff;04000701=202020ff;04000801=202020ff;05000101=00000000;05000201=00000000;05000301=00000000;05000401=000000ff;05000501=000000ff;05000601=000000ff;05000701=000000ff;05000801=202020ff;06000101=00000000;06000201=000000ff;06000301=000000ff;06000401=404040ff;06000501=000000ff;06000601=000000ff;06000701=000000ff;06000801=202020ff;07000101=000000ff;07000201=202020ff;07000301=202020ff;07000401=202020ff;07000501=404040ff;07000601=000000ff;07000701=000000ff;07000801=000000ff;08000101=000000ff;08000201=202020ff;08000301=202020ff;08000401=202020ff;08000501=404040ff;08000601=000000ff;08000701=000000ff;08000801=000000ff;09000101=000000ff;09000201=202020ff;09000301=202020ff;09000401=202020ff;09000501=202020ff;09000601=404040ff;09000701=000000ff;09000801=202020ff;10000101=000000ff;10000201=000000ff;10000301=202020ff;10000401=202020ff;10000501=202020ff;10000601=000000ff;10000701=202020ff;10000801=202020ff;11000101=000000ff;11000201=000000ff;11000301=000000ff;11000401=202020ff;11000501=000000ff;11000601=202020ff;11000701=202020ff;11000801=202020ff;12000101=404040ff;12000201=000000ff;12000301=000000ff;12000401=000000ff;12000501=202020ff;12000601=202020ff;12000701=202020ff;12000801=000000ff;13000101=202020ff;13000201=404040ff;13000301=000000ff;13000401=202020ff;13000501=202020ff;13000601=202020ff;13000701=000000ff;13000801=000000ff;14000101=202020ff;14000201=000000ff;14000301=000000ff;14000401=202020ff;14000501=202020ff;14000601=000000ff;14000701=000000ff;14000801=202020ff;15000101=202020ff;15000201=000000ff;15000301=202020ff;15000401=202020ff;15000501=000000ff;15000601=000000ff;15000701=000000ff;15000801=000000ff;16000101=000000ff;16000201=000000ff;16000301=202020ff;16000401=202020ff;16000501=000000ff;16000601=202020ff;16000701=202020ff;16000801=404040ff;17000101=000000ff;17000201=000000ff;17000301=202020ff;17000401=000000ff;17000501=000000ff;17000601=202020ff;17000701=202020ff;17000801=202020ff;18000101=000000ff;18000201=202020ff;18000301=202020ff;18000401=000000ff;18000501=000000ff;18000601=000000ff;18000701=202020ff;18000801=202020ff;19000101=000000ff;19000201=202020ff;19000301=202020ff;19000401=000000ff;19000501=000000ff;19000601=000000ff;19000701=000000ff;19000801=000000ff;20000101=000000ff;20000201=202020ff;20000301=000000ff;20000401=000000ff;20000501=202020ff;20000601=202020ff;20000701=202020ff;20000801=404040ff;21000101=202020ff;21000201=202020ff;21000301=000000ff;21000401=000000ff;21000501=202020ff;21000601=202020ff;21000701=202020ff;21000801=202020ff;22000101=202020ff;22000201=202020ff;22000301=000000ff;22000401=000000ff;22000501=000000ff;22000601=202020ff;22000701=202020ff;22000801=202020ff;23000101=202020ff;23000201=000000ff;23000301=000000ff;23000401=000000ff;23000501=000000ff;23000601=000000ff;23000701=000000ff;23000801=000000ff;24000101=202020ff;24000201=000000ff;24000301=000000ff;24000401=202020ff;24000501=202020ff;24000601=404040ff;24000701=404040ff;24000801=404040ff;25000101=202020ff;25000201=000000ff;25000301=000000ff;25000401=202020ff;25000501=202020ff;25000601=202020ff;25000701=404040ff;25000801=000000ff;26000101=202020ff;26000201=000000ff;26000301=000000ff;26000401=202020ff;26000501=202020ff;26000601=202020ff;26000701=404040ff;26000801=000000ff;27000101=000000ff;27000201=202020ff;27000301=000000ff;27000401=000000ff;27000501=202020ff;27000601=404040ff;27000701=000000ff;27000801=202020ff;28000101=000000ff;28000201=000000ff;28000301=202020ff;28000401=000000ff;28000501=000000ff;28000601=000000ff;28000701=202020ff;28000801=202020ff;29000101=000000ff;29000201=000000ff;29000301=000000ff;29000401=404040ff;29000501=000000ff;29000601=000000ff;29000701=000000ff;29000801=202020ff;30000101=000000ff;30000201=202020ff;30000301=202020ff;30000401=202020ff;30000501=404040ff;30000601=000000ff;30000701=000000ff;30000801=202020ff;31000101=000000ff;31000201=000000ff;31000301=202020ff;31000401=202020ff;31000501=404040ff;31000601=000000ff;31000701=000000ff;31000801=000000ff;32000101=000000ff;32000201=000000ff;32000301=000000ff;32000401=202020ff;32000501=202020ff;32000601=404040ff;32000701=000000ff;32000801=000000ff?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-16?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=000000ff;01000801=000000ff;02000101=00000000;02000201=000000ff;02000301=000000ff;02000401=000000ff;02000501=000000ff;02000601=000000ff;02000701=202020ff;02000801=404040ff;03000101=000000ff;03000201=404040ff;03000301=000000ff;03000401=000000ff;03000501=000000ff;03000601=202020ff;03000701=202020ff;03000801=202020ff;04000101=202020ff;04000201=202020ff;04000301=404040ff;04000401=000000ff;04000501=000000ff;04000601=202020ff;04000701=202020ff;04000801=202020ff;05000101=202020ff;05000201=202020ff;05000301=404040ff;05000401=000000ff;05000501=000000ff;05000601=000000ff;05000701=202020ff;05000801=000000ff;06000101=202020ff;06000201=202020ff;06000301=202020ff;06000401=404040ff;06000501=000000ff;06000601=000000ff;06000701=000000ff;06000801=000000ff;07000101=202020ff;07000201=000000ff;07000301=000000ff;07000401=000000ff;07000501=202020ff;07000601=404040ff;07000701=404040ff;07000801=000000ff;08000101=000000ff;08000201=404040ff;08000301=000000ff;08000401=202020ff;08000501=202020ff;08000601=202020ff;08000701=404040ff;08000801=000000ff;09000101=404040ff;09000201=404040ff;09000301=000000ff;09000401=202020ff;09000501=202020ff;09000601=202020ff;09000701=404040ff;09000801=000000ff;10000101=202020ff;10000201=404040ff;10000301=000000ff;10000401=000000ff;10000501=202020ff;10000601=202020ff;10000701=404040ff;10000801=000000ff;11000101=000000ff;11000201=000000ff;11000301=000000ff;11000401=000000ff;11000501=202020ff;11000601=202020ff;11000701=404040ff;11000801=000000ff;12000101=404040ff;12000201=404040ff;12000301=000000ff;12000401=000000ff;12000501=202020ff;12000601=202020ff;12000701=404040ff;12000801=000000ff;13000101=202020ff;13000201=404040ff;13000301=000000ff;13000401=000000ff;13000501=000000ff;13000601=202020ff;13000701=404040ff;13000801=000000ff;14000101=202020ff;14000201=404040ff;14000301=000000ff;14000401=000000ff;14000501=000000ff;14000601=202020ff;14000701=202020ff;14000801=000000ff;15000101=000000ff;15000201=000000ff;15000301=000000ff;15000401=000000ff;15000501=000000ff;15000601=000000ff;15000701=404040ff;15000801=000000ff;16000101=404040ff;16000201=404040ff;16000301=000000ff;16000401=202020ff;16000501=404040ff;16000601=000000ff;16000701=202020ff;16000801=000000ff;17000101=404040ff;17000201=000000ff;17000301=000000ff;17000401=202020ff;17000501=202020ff;17000601=404040ff;17000701=000000ff;17000801=008700ff;18000101=404040ff;18000201=000000ff;18000301=000000ff;18000401=202020ff;18000501=202020ff;18000601=404040ff;18000701=000000ff;18000801=00c100b4;19000101=000000ff;19000201=000000ff;19000301=000000ff;19000401=000000ff;19000501=202020ff;19000601=404040ff;19000701=000000ff;19000801=00c100b4;20000101=404040ff;20000201=000000ff;20000301=000000ff;20000401=000000ff;20000501=202020ff;20000601=202020ff;20000701=000000ff;20000801=000000ff;21000101=404040ff;21000201=000000ff;21000301=000000ff;21000401=000000ff;21000501=000000ff;21000601=202020ff;21000701=000000ff;21000801=404040ff;22000101=404040ff;22000201=000000ff;22000301=202020ff;22000401=404040ff;22000501=000000ff;22000601=202020ff;22000701=000000ff;22000801=000000ff;23000101=000000ff;23000201=202020ff;23000301=202020ff;23000401=202020ff;23000501=404040ff;23000601=000000ff;23000701=00000000;23000801=000000ff;24000101=000000ff;24000201=000000ff;24000301=202020ff;24000401=202020ff;24000501=404040ff;24000601=000000ff;24000701=00000000;24000801=000000ff;25000101=000000ff;25000201=000000ff;25000301=202020ff;25000401=202020ff;25000501=404040ff;25000601=000000ff;25000701=00000000;25000801=000000ff;26000101=000000ff;26000201=000000ff;26000301=202020ff;26000401=202020ff;26000501=000000ff;26000601=000000ff;26000701=000000ff;26000801=404040ff;27000101=000000ff;27000201=000000ff;27000301=000000ff;27000401=202020ff;27000501=000000ff;27000601=202020ff;27000701=000000ff;27000801=404040ff;28000101=202020ff;28000201=404040ff;28000301=000000ff;28000401=000000ff;28000501=000000ff;28000601=000000ff;28000701=000000ff;28000801=202020ff;29000101=202020ff;29000201=202020ff;29000301=404040ff;29000401=000000ff;29000501=00000000;29000601=000000ff;29000701=404040ff;29000801=000000ff;30000101=202020ff;30000201=202020ff;30000301=000000ff;30000401=000000ff;30000501=00000000;30000601=000000ff;30000701=202020ff;30000801=000000ff;31000101=000000ff;31000201=000000ff;31000301=404040ff;31000401=000000ff;31000501=00000000;31000601=000000ff;31000701=404040ff;31000801=000000ff;32000101=202020ff;32000201=404040ff;32000301=404040ff;32000401=000000ff;32000501=00000000;32000601=000000ff;32000701=202020ff;32000801=000000ff?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-24?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=000000ff;01000501=000000ff;01000601=000000ff;01000701=000000ff;01000801=000000ff;02000101=404040ff;02000201=000000ff;02000301=202020ff;02000401=404040ff;02000501=404040ff;02000601=000000ff;02000701=000000ff;02000801=404040ff;03000101=404040ff;03000201=000000ff;03000301=000000ff;03000401=000000ff;03000501=000000ff;03000601=404040ff;03000701=404040ff;03000801=000000ff;04000101=404040ff;04000201=000000ff;04000301=099009ff;04000401=139a13ff;04000501=099009ff;04000601=000000ff;04000701=000000ff;04000801=404040ff;05000101=000000ff;05000201=202020ff;05000301=000000ff;05000401=008700ff;05000501=008700ff;05000601=008700ff;05000701=008700ff;05000801=000000ff;06000101=099009ff;06000201=000000ff;06000301=202020ff;06000401=000000ff;06000501=099009ff;06000601=099009ff;06000701=099009ff;06000801=000000ff;07000101=008700ff;07000201=099009ff;07000301=000000ff;07000401=202020ff;07000501=000000ff;07000601=008700ff;07000701=008700ff;07000801=008700ff;08000101=008700ff;08000201=099009ff;08000301=008700ff;08000401=000000ff;08000501=404040ff;08000601=000000ff;08000701=099009ff;08000801=099009ff;09000101=008700ff;09000201=099009ff;09000301=008700ff;09000401=099009ff;09000501=000000ff;09000601=202020ff;09000701=000000ff;09000801=008700ff;10000101=008700ff;10000201=099009ff;10000301=008700ff;10000401=099009ff;10000501=099009ff;10000601=000000ff;10000701=404040ff;10000801=000000ff;11000101=008700ff;11000201=099009ff;11000301=008700ff;11000401=099009ff;11000501=099009ff;11000601=099009ff;11000701=000000ff;11000801=404040ff;12000101=000000ff;12000201=099009ff;12000301=008700ff;12000401=099009ff;12000501=099009ff;12000601=099009ff;12000701=099009ff;12000801=000000ff;13000101=202020ff;13000201=000000ff;13000301=008700ff;13000401=099009ff;13000501=099009ff;13000601=008700ff;13000701=008700ff;13000801=000000ff;14000101=000000ff;14000201=404040ff;14000301=000000ff;14000401=099009ff;14000501=099009ff;14000601=099009ff;14000701=099009ff;14000801=000000ff;15000101=008700ff;15000201=000000ff;15000301=202020ff;15000401=000000ff;15000501=008700ff;15000601=008700ff;15000701=008700ff;15000801=000000ff;16000101=099009ff;16000201=099009ff;16000301=000000ff;16000401=404040ff;16000501=000000ff;16000601=099009ff;16000701=000000ff;16000801=404040ff;17000101=008700ff;17000201=008700ff;17000301=008700ff;17000401=000000ff;17000501=404040ff;17000601=000000ff;17000701=202020ff;17000801=000000ff;18000101=00c100b4;18000201=00c100b4;18000301=00c100b4;18000401=00c100b4;18000501=000000ff;18000601=202020ff;18000701=000000ff;18000801=00000000;19000101=00c100b4;19000201=00c100b4;19000301=000000ff;19000401=000000ff;19000501=404040ff;19000601=000000ff;19000701=00000000;19000801=00000000;20000101=000000ff;20000201=000000ff;20000301=404040ff;20000401=202020ff;20000501=000000ff;20000601=00000000;20000701=00000000;20000801=00000000;21000101=404040ff;21000201=202020ff;21000301=000000ff;21000401=000000ff;21000501=00000000;21000601=00000000;21000701=00000000;21000801=00000000;22000101=000000ff;22000201=000000ff;22000301=00000000;22000401=00000000;22000501=00000000;22000601=00000000;22000701=00000000;22000801=00000000;23000101=404040ff;23000201=000000ff;23000301=00000000;23000401=00000000;23000501=00000000;23000601=00000000;23000701=00000000;23000801=00000000;24000101=404040ff;24000201=000000ff;24000301=00000000;24000401=00000000;24000501=00000000;24000601=00000000;24000701=00000000;24000801=00000000;25000101=404040ff;25000201=000000ff;25000301=00000000;25000401=00000000;25000501=00000000;25000601=00000000;25000701=00000000;25000801=00000000;26000101=000000ff;26000201=00000000;26000301=00000000;26000401=00000000;26000501=00000000;26000601=00000000;26000701=00000000;26000801=00000000;27000101=000000ff;27000201=00000000;27000301=00000000;27000401=00000000;27000501=00000000;27000601=00000000;27000701=00000000;27000801=00000000;28000101=000000ff;28000201=00000000;28000301=00000000;28000401=00000000;28000501=00000000;28000601=00000000;28000701=00000000;28000801=00000000;29000101=00000000;29000201=00000000;29000301=00000000;29000401=00000000;29000501=00000000;29000601=00000000;29000701=00000000;29000801=00000000;30000101=00000000;30000201=00000000;30000301=00000000;30000401=00000000;30000501=00000000;30000601=00000000;30000701=00000000;30000801=00000000;31000101=00000000;31000201=00000000;31000301=00000000;31000401=00000000;31000501=00000000;31000601=00000000;31000701=00000000;31000801=00000000;32000101=00000000;32000201=00000000;32000301=00000000;32000401=00000000;32000501=00000000;32000601=00000000;32000701=00000000;32000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-32?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=000000ff;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=404040ff;02000201=808080ff;02000301=808080ff;02000401=000000ff;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=404040ff;03000201=000000ff;03000301=808080ff;03000401=000000ff;03000501=00000000;03000601=00000000;03000701=00000000;03000801=00000000;04000101=000000ff;04000201=404040ff;04000301=808080ff;04000401=000000ff;04000501=000000ff;04000601=000000ff;04000701=000000ff;04000801=004000ff;05000101=404040ff;05000201=000000ff;05000301=000000ff;05000401=000000ff;05000501=404040ff;05000601=404040ff;05000701=404040ff;05000801=00c000ff;06000101=404040ff;06000201=000000ff;06000301=404040ff;06000401=000000ff;06000501=202020ff;06000601=202020ff;06000701=202020ff;06000801=00c000ff;07000101=000000ff;07000201=404040ff;07000301=000000ff;07000401=000000ff;07000501=202020ff;07000601=202020ff;07000701=202020ff;07000801=008000ff;08000101=000000ff;08000201=404040ff;08000301=000000ff;08000401=000000ff;08000501=000000ff;08000601=000000ff;08000701=000000ff;08000801=004000ff;09000101=000000ff;09000201=404040ff;09000301=000000ff;09000401=000000ff;09000501=00000000;09000601=00000000;09000701=00000000;09000801=00000000;10000101=000000ff;10000201=202020ff;10000301=000000ff;10000401=000000ff;10000501=00000000;10000601=00000000;10000701=00000000;10000801=00000000;11000101=000000ff;11000201=404040ff;11000301=000000ff;11000401=000000ff;11000501=000000ff;11000601=000000ff;11000701=000000ff;11000801=004000ff;12000101=404040ff;12000201=000000ff;12000301=202020ff;12000401=000000ff;12000501=404040ff;12000601=404040ff;12000701=404040ff;12000801=00c000ff;13000101=404040ff;13000201=000000ff;13000301=202020ff;13000401=000000ff;13000501=202020ff;13000601=202020ff;13000701=202020ff;13000801=008000ff;14000101=202020ff;14000201=000000ff;14000301=202020ff;14000401=000000ff;14000501=202020ff;14000601=202020ff;14000701=202020ff;14000801=008000ff;15000101=404040ff;15000201=000000ff;15000301=202020ff;15000401=000000ff;15000501=000000ff;15000601=000000ff;15000701=000000ff;15000801=004000ff;16000101=000000ff;16000201=202020ff;16000301=202020ff;16000401=000000ff;16000501=00000000;16000601=00000000;16000701=00000000;16000801=00000000;17000101=000000ff;17000201=000000ff;17000301=000000ff;17000401=000000ff;17000501=00000000;17000601=00000000;17000701=00000000;17000801=00000000;18000101=00000000;18000201=00000000;18000301=00000000;18000401=00000000;18000501=00000000;18000601=00000000;18000701=00000000;18000801=00000000;19000101=00000000;19000201=00000000;19000301=00000000;19000401=00000000;19000501=00000000;19000601=00000000;19000701=00000000;19000801=00000000;20000101=00000000;20000201=00000000;20000301=00000000;20000401=00000000;20000501=00000000;20000601=00000000;20000701=00000000;20000801=00000000;21000101=00000000;21000201=00000000;21000301=00000000;21000401=00000000;21000501=00000000;21000601=00000000;21000701=00000000;21000801=00000000;22000101=00000000;22000201=00000000;22000301=00000000;22000401=00000000;22000501=00000000;22000601=00000000;22000701=00000000;22000801=00000000;23000101=00000000;23000201=00000000;23000301=00000000;23000401=00000000;23000501=00000000;23000601=00000000;23000701=00000000;23000801=00000000;24000101=00000000;24000201=00000000;24000301=00000000;24000401=00000000;24000501=00000000;24000601=00000000;24000701=00000000;24000801=00000000;25000101=00000000;25000201=00000000;25000301=00000000;25000401=00000000;25000501=00000000;25000601=00000000;25000701=00000000;25000801=00000000;26000101=00000000;26000201=00000000;26000301=00000000;26000401=00000000;26000501=00000000;26000601=00000000;26000701=00000000;26000801=00000000;27000101=00000000;27000201=00000000;27000301=00000000;27000401=00000000;27000501=00000000;27000601=00000000;27000701=00000000;27000801=00000000;28000101=00000000;28000201=00000000;28000301=00000000;28000401=00000000;28000501=00000000;28000601=00000000;28000701=00000000;28000801=00000000;29000101=00000000;29000201=00000000;29000301=00000000;29000401=00000000;29000501=00000000;29000601=00000000;29000701=00000000;29000801=00000000;30000101=00000000;30000201=00000000;30000301=00000000;30000401=00000000;30000501=00000000;30000601=00000000;30000701=00000000;30000801=00000000;31000101=00000000;31000201=00000000;31000301=00000000;31000401=00000000;31000501=00000000;31000601=00000000;31000701=00000000;31000801=00000000;32000101=00000000;32000201=00000000;32000301=00000000;32000401=00000000;32000501=00000000;32000601=00000000;32000701=00000000;32000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-40?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=00000000;03000201=00000000;03000301=000000ff;03000401=000000ff;03000501=00000000;03000601=00000000;03000701=00000000;03000801=00000000;04000101=000000ff;04000201=004000ff;04000301=808080ff;04000401=000000ff;04000501=00000000;04000601=00000000;04000701=00000000;04000801=00000000;05000101=404040ff;05000201=00ff00ff;05000301=808080ff;05000401=000000ff;05000501=00000000;05000601=00000000;05000701=00000000;05000801=00000000;06000101=404040ff;06000201=00c000ff;06000301=404040ff;06000401=000000ff;06000501=00000000;06000601=00000000;06000701=00000000;06000801=00000000;07000101=202020ff;07000201=008000ff;07000301=202020ff;07000401=000000ff;07000501=00000000;07000601=00000000;07000701=00000000;07000801=00000000;08000101=000000ff;08000201=004000ff;08000301=202020ff;08000401=000000ff;08000501=00000000;08000601=00000000;08000701=00000000;08000801=00000000;09000101=00000000;09000201=00000000;09000301=000000ff;09000401=000000ff;09000501=00000000;09000601=00000000;09000701=000000ff;09000801=000000ff;10000101=00000000;10000201=00000000;10000301=00000000;10000401=00000000;10000501=00000000;10000601=000000ff;10000701=808080ff;10000801=000000ff;11000101=004000ff;11000201=000000ff;11000301=004000ff;11000401=000000ff;11000501=004000ff;11000601=808080ff;11000701=808080ff;11000801=000000ff;12000101=00c000ff;12000201=404040ff;12000301=00c000ff;12000401=404040ff;12000501=00c000ff;12000601=404040ff;12000701=808080ff;12000801=000000ff;13000101=008000ff;13000201=202020ff;13000301=008000ff;13000401=202020ff;13000501=00c000ff;13000601=404040ff;13000701=404040ff;13000801=000000ff;14000101=008000ff;14000201=202020ff;14000301=008000ff;14000401=202020ff;14000501=008000ff;14000601=202020ff;14000701=404040ff;14000801=000000ff;15000101=004000ff;15000201=000000ff;15000301=004000ff;15000401=000000ff;15000501=004000ff;15000601=202020ff;15000701=202020ff;15000801=000000ff;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;16000501=00000000;16000601=000000ff;16000701=202020ff;16000801=000000ff;17000101=00000000;17000201=00000000;17000301=00000000;17000401=00000000;17000501=00000000;17000601=00000000;17000701=000000ff;17000801=000000ff;18000101=00000000;18000201=00000000;18000301=00000000;18000401=00000000;18000501=00000000;18000601=00000000;18000701=00000000;18000801=00000000;19000101=00000000;19000201=00000000;19000301=00000000;19000401=00000000;19000501=00000000;19000601=00000000;19000701=00000000;19000801=00000000;20000101=00000000;20000201=00000000;20000301=00000000;20000401=00000000;20000501=00000000;20000601=00000000;20000701=00000000;20000801=00000000;21000101=00000000;21000201=00000000;21000301=00000000;21000401=00000000;21000501=00000000;21000601=00000000;21000701=00000000;21000801=00000000;22000101=00000000;22000201=00000000;22000301=00000000;22000401=00000000;22000501=00000000;22000601=00000000;22000701=00000000;22000801=00000000;23000101=00000000;23000201=00000000;23000301=00000000;23000401=00000000;23000501=00000000;23000601=00000000;23000701=00000000;23000801=00000000;24000101=00000000;24000201=00000000;24000301=00000000;24000401=00000000;24000501=00000000;24000601=00000000;24000701=00000000;24000801=00000000;25000101=00000000;25000201=00000000;25000301=00000000;25000401=00000000;25000501=00000000;25000601=00000000;25000701=00000000;25000801=00000000;26000101=00000000;26000201=00000000;26000301=00000000;26000401=00000000;26000501=00000000;26000601=00000000;26000701=00000000;26000801=00000000;27000101=00000000;27000201=00000000;27000301=00000000;27000401=00000000;27000501=00000000;27000601=00000000;27000701=00000000;27000801=00000000;28000101=00000000;28000201=00000000;28000301=00000000;28000401=00000000;28000501=00000000;28000601=00000000;28000701=00000000;28000801=00000000;29000101=00000000;29000201=00000000;29000301=00000000;29000401=00000000;29000501=00000000;29000601=00000000;29000701=00000000;29000801=00000000;30000101=00000000;30000201=00000000;30000301=00000000;30000401=00000000;30000501=00000000;30000601=00000000;30000701=00000000;30000801=00000000;31000101=00000000;31000201=00000000;31000301=00000000;31000401=00000000;31000501=00000000;31000601=00000000;31000701=00000000;31000801=00000000;32000101=00000000;32000201=00000000;32000301=00000000;32000401=00000000;32000501=00000000;32000601=00000000;32000701=00000000;32000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;0?replace;01000101=00000000;01000201=00000000;01000301=000000ff;01000401=000000ff;01000501=000000ff;01000601=202020ff;01000701=202020ff;01000801=404040ff;02000101=00000000;02000201=00000000;02000301=000000ff;02000401=000000ff;02000501=000000ff;02000601=000000ff;02000701=202020ff;02000801=202020ff;03000101=00000000;03000201=00000000;03000301=00000000;03000401=000000ff;03000501=000000ff;03000601=000000ff;03000701=202020ff;03000801=202020ff;04000101=00000000;04000201=00000000;04000301=00000000;04000401=000000ff;04000501=000000ff;04000601=000000ff;04000701=000000ff;04000801=202020ff;05000101=00000000;05000201=00000000;05000301=00000000;05000401=00000000;05000501=000000ff;05000601=000000ff;05000701=000000ff;05000801=000000ff;06000101=00000000;06000201=00000000;06000301=00000000;06000401=00000000;06000501=00000000;06000601=000000ff;06000701=000000ff;06000801=000000ff;07000101=00000000;07000201=00000000;07000301=00000000;07000401=00000000;07000501=00000000;07000601=000000ff;07000701=000000ff;07000801=000000ff;08000101=00000000;08000201=00000000;08000301=00000000;08000401=00000000;08000501=00000000;08000601=00000000;08000701=000000ff;08000801=000000ff;09000101=00000000;09000201=00000000;09000301=00000000;09000401=00000000;09000501=00000000;09000601=00000000;09000701=00000000;09000801=000000ff;10000101=00000000;10000201=00000000;10000301=00000000;10000401=00000000;10000501=00000000;10000601=00000000;10000701=00000000;10000801=00000000;11000101=00000000;11000201=00000000;11000301=00000000;11000401=00000000;11000501=00000000;11000601=00000000;11000701=00000000;11000801=00000000;12000101=00000000;12000201=00000000;12000301=00000000;12000401=00000000;12000501=00000000;12000601=00000000;12000701=00000000;12000801=00000000;13000101=00000000;13000201=00000000;13000301=00000000;13000401=00000000;13000501=00000000;13000601=00000000;13000701=00000000;13000801=00000000;14000101=00000000;14000201=00000000;14000301=00000000;14000401=00000000;14000501=00000000;14000601=00000000;14000701=00000000;14000801=00000000;15000101=00000000;15000201=00000000;15000301=00000000;15000401=00000000;15000501=00000000;15000601=00000000;15000701=00000000;15000801=00000000;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;16000501=00000000;16000601=00000000;16000701=00000000;16000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;-8?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=000000ff;01000501=000000ff;01000601=000000ff;01000701=202020ff;01000801=202020ff;02000101=404040ff;02000201=000000ff;02000301=000000ff;02000401=202020ff;02000501=202020ff;02000601=202020ff;02000701=202020ff;02000801=202020ff;03000101=404040ff;03000201=000000ff;03000301=000000ff;03000401=202020ff;03000501=202020ff;03000601=202020ff;03000701=000000ff;03000801=000000ff;04000101=202020ff;04000201=000000ff;04000301=000000ff;04000401=000000ff;04000501=000000ff;04000601=000000ff;04000701=202020ff;04000801=000000ff;05000101=000000ff;05000201=404040ff;05000301=000000ff;05000401=000000ff;05000501=000000ff;05000601=202020ff;05000701=202020ff;05000801=000000ff;06000101=202020ff;06000201=202020ff;06000301=404040ff;06000401=000000ff;06000501=000000ff;06000601=000000ff;06000701=000000ff;06000801=202020ff;07000101=202020ff;07000201=202020ff;07000301=202020ff;07000401=404040ff;07000501=000000ff;07000601=000000ff;07000701=000000ff;07000801=202020ff;08000101=000000ff;08000201=202020ff;08000301=202020ff;08000401=202020ff;08000501=000000ff;08000601=000000ff;08000701=000000ff;08000801=202020ff;09000101=000000ff;09000201=000000ff;09000301=202020ff;09000401=000000ff;09000501=202020ff;09000601=404040ff;09000701=000000ff;09000801=000000ff;10000101=000000ff;10000201=000000ff;10000301=000000ff;10000401=000000ff;10000501=000000ff;10000601=202020ff;10000701=404040ff;10000801=000000ff;11000101=00000000;11000201=000000ff;11000301=000000ff;11000401=000000ff;11000501=000000ff;11000601=202020ff;11000701=202020ff;11000801=404040ff;12000101=00000000;12000201=00000000;12000301=00000000;12000401=000000ff;12000501=000000ff;12000601=000000ff;12000701=202020ff;12000801=202020ff;13000101=00000000;13000201=00000000;13000301=00000000;13000401=00000000;13000501=000000ff;13000601=000000ff;13000701=000000ff;13000801=202020ff;14000101=00000000;14000201=00000000;14000301=00000000;14000401=00000000;14000501=00000000;14000601=00000000;14000701=000000ff;14000801=000000ff;15000101=00000000;15000201=00000000;15000301=00000000;15000401=00000000;15000501=00000000;15000601=00000000;15000701=00000000;15000801=000000ff;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;16000501=00000000;16000601=00000000;16000701=00000000;16000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;-16?replace;01000101=202020ff;01000201=202020ff;01000301=404040ff;01000401=000000ff;01000501=000000ff;01000601=000000ff;01000701=000000ff;01000801=000000ff;02000101=000000ff;02000201=202020ff;02000301=404040ff;02000401=000000ff;02000501=202020ff;02000601=202020ff;02000701=404040ff;02000801=404040ff;03000101=000000ff;03000201=202020ff;03000301=000000ff;03000401=000000ff;03000501=000000ff;03000601=000000ff;03000701=000000ff;03000801=000000ff;04000101=202020ff;04000201=202020ff;04000301=000000ff;04000401=000000ff;04000501=00c100b4;04000601=00c100b4;04000701=00c100b4;04000801=00c100b4;05000101=202020ff;05000201=202020ff;05000301=000000ff;05000401=404040ff;05000501=000000ff;05000601=008700ff;05000701=008700ff;05000801=008700ff;06000101=202020ff;06000201=000000ff;06000301=202020ff;06000401=404040ff;06000501=808080ff;06000601=000000ff;06000701=000000ff;06000801=000000ff;07000101=202020ff;07000201=000000ff;07000301=202020ff;07000401=202020ff;07000501=404040ff;07000601=808080ff;07000701=000000ff;07000801=202020ff;08000101=000000ff;08000201=202020ff;08000301=202020ff;08000401=404040ff;08000501=404040ff;08000601=404040ff;08000701=000000ff;08000801=000000ff;09000101=000000ff;09000201=000000ff;09000301=000000ff;09000401=000000ff;09000501=000000ff;09000601=000000ff;09000701=000000ff;09000801=00c100b4;10000101=000000ff;10000201=202020ff;10000301=202020ff;10000401=202020ff;10000501=404040ff;10000601=404040ff;10000701=000000ff;10000801=008700ff;11000101=000000ff;11000201=202020ff;11000301=008000ff;11000401=00ff00ff;11000501=00ff00ff;11000601=404040ff;11000701=000000ff;11000801=008700ff;12000101=000000ff;12000201=000000ff;12000301=008000ff;12000401=00c000ff;12000501=00ff00ff;12000601=202020ff;12000701=000000ff;12000801=008700ff;13000101=000000ff;13000201=000000ff;13000301=008000ff;13000401=008000ff;13000501=00ff00ff;13000601=404040ff;13000701=000000ff;13000801=00c100b4;14000101=000000ff;14000201=000000ff;14000301=000000ff;14000401=202020ff;14000501=202020ff;14000601=202020ff;14000701=000000ff;14000801=00c000e8;15000101=000000ff;15000201=000000ff;15000301=000000ff;15000401=000000ff;15000501=000000ff;15000601=000000ff;15000701=000000ff;15000801=008e00e8;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;16000501=00000000;16000601=00000000;16000701=00000000;16000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;-24?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=000000ff;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=404040ff;03000201=000000ff;03000301=00000000;03000401=00000000;03000501=00000000;03000601=00000000;03000701=00000000;03000801=00000000;04000101=000000ff;04000201=404040ff;04000301=000000ff;04000401=00000000;04000501=00000000;04000601=00000000;04000701=00000000;04000801=00000000;05000101=008700ff;05000201=000000ff;05000301=202020ff;05000401=000000ff;05000501=00000000;05000601=00000000;05000701=00000000;05000801=00000000;06000101=000000ff;06000201=000000ff;06000301=404040ff;06000401=000000ff;06000501=00000000;06000601=00000000;06000701=00000000;06000801=00000000;07000101=202020ff;07000201=202020ff;07000301=000000ff;07000401=404040ff;07000501=000000ff;07000601=00000000;07000701=00000000;07000801=00000000;08000101=000000ff;08000201=000000ff;08000301=000000ff;08000401=404040ff;08000501=000000ff;08000601=00000000;08000701=00000000;08000801=00000000;09000101=00c100b4;09000201=00c100b4;09000301=00c100b4;09000401=000000ff;09000501=404040ff;09000601=000000ff;09000701=00000000;09000801=00000000;10000101=008700ff;10000201=008700ff;10000301=008700ff;10000401=000000ff;10000501=404040ff;10000601=000000ff;10000701=00000000;10000801=00000000;11000101=008700ff;11000201=008700ff;11000301=008700ff;11000401=008700ff;11000501=000000ff;11000601=404040ff;11000701=000000ff;11000801=00000000;12000101=008700ff;12000201=008700ff;12000301=008700ff;12000401=008700ff;12000501=000000ff;12000601=404040ff;12000701=000000ff;12000801=00000000;13000101=00c100b4;13000201=00c100b4;13000301=00c100b4;13000401=00c100b4;13000501=000000ff;13000601=404040ff;13000701=000000ff;13000801=00000000;14000101=00c000e8;14000201=00c000e8;14000301=00c000e8;14000401=00c000e8;14000501=000000ff;14000601=202020ff;14000701=000000ff;14000801=00000000;15000101=008e00e8;15000201=008e00e8;15000301=008e00e8;15000401=008e00e8;15000501=000000ff;15000601=000000ff;15000701=00000000;15000801=00000000;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;16000501=00000000;16000601=00000000;16000701=00000000;16000801=00000000?replace;ffffffff=00000000")
	animator.setGlobalTag("backLegSprite", "?setcolor=ffffff?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=1?crop=0;0;18;12?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=404040ff;02000201=404040ff;02000301=000000ff;02000401=000000ff;02000501=000000ff;02000601=000000ff;02000701=00000000;02000801=00000000;03000101=202020ff;03000201=404040ff;03000301=000000ff;03000401=202020ff;03000501=404040ff;03000601=202020ff;03000701=000000ff;03000801=000000ff;04000101=202020ff;04000201=404040ff;04000301=000000ff;04000401=202020ff;04000501=000000ff;04000601=000000ff;04000701=404040ff;04000801=404040ff;05000101=202020ff;05000201=404040ff;05000301=000000ff;05000401=202020ff;05000501=000000ff;05000601=00000000;05000701=000000ff;05000801=000000ff;06000101=202020ff;06000201=202020ff;06000301=000000ff;06000401=202020ff;06000501=000000ff;06000601=00000000;06000701=00000000;06000801=00000000;07000101=202020ff;07000201=404040ff;07000301=000000ff;07000401=202020ff;07000501=000000ff;07000601=00000000;07000701=00000000;07000801=008000ff;08000101=202020ff;08000201=404040ff;08000301=000000ff;08000401=202020ff;08000501=000000ff;08000601=00000000;08000701=008000ff;08000801=00ff00ff;09000101=202020ff;09000201=202020ff;09000301=000000ff;09000401=202020ff;09000501=000000ff;09000601=00000000;09000701=008000ff;09000801=00c000ff;10000101=202020ff;10000201=404040ff;10000301=000000ff;10000401=202020ff;10000501=000000ff;10000601=00000000;10000701=008000ff;10000801=00c000ff;11000101=202020ff;11000201=202020ff;11000301=000000ff;11000401=202020ff;11000501=000000ff;11000601=00000000;11000701=008000ff;11000801=00c000ff;12000101=202020ff;12000201=202020ff;12000301=000000ff;12000401=202020ff;12000501=000000ff;12000601=00000000;12000701=00000000;12000801=008000ff;13000101=202020ff;13000201=202020ff;13000301=000000ff;13000401=202020ff;13000501=000000ff;13000601=00000000;13000701=00000000;13000801=00000000;14000101=202020ff;14000201=202020ff;14000301=000000ff;14000401=202020ff;14000501=000000ff;14000601=00000000;14000701=000000ff;14000801=000000ff;15000101=202020ff;15000201=202020ff;15000301=000000ff;15000401=202020ff;15000501=000000ff;15000601=000000ff;15000701=202020ff;15000801=202020ff;16000101=202020ff;16000201=202020ff;16000301=000000ff;16000401=202020ff;16000501=202020ff;16000601=202020ff;16000701=000000ff;16000801=000000ff;17000101=202020ff;17000201=202020ff;17000301=000000ff;17000401=000000ff;17000501=000000ff;17000601=000000ff;17000701=00000000;17000801=00000000;18000101=000000ff;18000201=000000ff;18000301=000000ff;18000401=00000000;18000501=00000000;18000601=00000000;18000701=00000000;18000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-8?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;03000101=00000000;03000201=00000000;03000301=00000000;03000401=00000000;04000101=000000ff;04000201=00000000;04000301=00000000;04000401=00000000;05000101=404040ff;05000201=000000ff;05000301=00000000;05000401=00000000;06000101=000000ff;06000201=404040ff;06000301=000000ff;06000401=00000000;07000101=000000ff;07000201=404040ff;07000301=000000ff;07000401=00000000;08000101=00ff00ff;08000201=000000ff;08000301=404040ff;08000401=000000ff;09000101=00ff00ff;09000201=000000ff;09000301=404040ff;09000401=000000ff;10000101=00c000ff;10000201=000000ff;10000301=202020ff;10000401=000000ff;11000101=00ff00ff;11000201=000000ff;11000301=404040ff;11000401=000000ff;12000101=000000ff;12000201=202020ff;12000301=000000ff;12000401=00000000;13000101=000000ff;13000201=202020ff;13000301=000000ff;13000401=00000000;14000101=202020ff;14000201=000000ff;14000301=00000000;14000401=00000000;15000101=000000ff;15000201=00000000;15000301=00000000;15000401=00000000;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;17000101=00000000;17000201=00000000;17000301=00000000;17000401=00000000;18000101=00000000;18000201=00000000;18000301=00000000;18000401=00000000?replace;ffffffff=00000000?brightness=-40")
	animator.setGlobalTag("frontLegSprite", "?setcolor=ffffff?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=1?crop=0;0;18;12?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=404040ff;02000201=404040ff;02000301=000000ff;02000401=000000ff;02000501=000000ff;02000601=000000ff;02000701=00000000;02000801=00000000;03000101=202020ff;03000201=404040ff;03000301=000000ff;03000401=202020ff;03000501=404040ff;03000601=202020ff;03000701=000000ff;03000801=000000ff;04000101=202020ff;04000201=404040ff;04000301=000000ff;04000401=202020ff;04000501=000000ff;04000601=000000ff;04000701=404040ff;04000801=404040ff;05000101=202020ff;05000201=404040ff;05000301=000000ff;05000401=202020ff;05000501=000000ff;05000601=00000000;05000701=000000ff;05000801=000000ff;06000101=202020ff;06000201=202020ff;06000301=000000ff;06000401=202020ff;06000501=000000ff;06000601=00000000;06000701=00000000;06000801=00000000;07000101=202020ff;07000201=404040ff;07000301=000000ff;07000401=202020ff;07000501=000000ff;07000601=00000000;07000701=00000000;07000801=008000ff;08000101=202020ff;08000201=404040ff;08000301=000000ff;08000401=202020ff;08000501=000000ff;08000601=00000000;08000701=008000ff;08000801=00ff00ff;09000101=202020ff;09000201=202020ff;09000301=000000ff;09000401=202020ff;09000501=000000ff;09000601=00000000;09000701=008000ff;09000801=00c000ff;10000101=202020ff;10000201=404040ff;10000301=000000ff;10000401=202020ff;10000501=000000ff;10000601=00000000;10000701=008000ff;10000801=00c000ff;11000101=202020ff;11000201=202020ff;11000301=000000ff;11000401=202020ff;11000501=000000ff;11000601=00000000;11000701=008000ff;11000801=00c000ff;12000101=202020ff;12000201=202020ff;12000301=000000ff;12000401=202020ff;12000501=000000ff;12000601=00000000;12000701=00000000;12000801=008000ff;13000101=202020ff;13000201=202020ff;13000301=000000ff;13000401=202020ff;13000501=000000ff;13000601=00000000;13000701=00000000;13000801=00000000;14000101=202020ff;14000201=202020ff;14000301=000000ff;14000401=202020ff;14000501=000000ff;14000601=00000000;14000701=000000ff;14000801=000000ff;15000101=202020ff;15000201=202020ff;15000301=000000ff;15000401=202020ff;15000501=000000ff;15000601=000000ff;15000701=202020ff;15000801=202020ff;16000101=202020ff;16000201=202020ff;16000301=000000ff;16000401=202020ff;16000501=202020ff;16000601=202020ff;16000701=000000ff;16000801=000000ff;17000101=202020ff;17000201=202020ff;17000301=000000ff;17000401=000000ff;17000501=000000ff;17000601=000000ff;17000701=00000000;17000801=00000000;18000101=000000ff;18000201=000000ff;18000301=000000ff;18000401=00000000;18000501=00000000;18000601=00000000;18000701=00000000;18000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-8?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;03000101=00000000;03000201=00000000;03000301=00000000;03000401=00000000;04000101=000000ff;04000201=00000000;04000301=00000000;04000401=00000000;05000101=404040ff;05000201=000000ff;05000301=00000000;05000401=00000000;06000101=000000ff;06000201=404040ff;06000301=000000ff;06000401=00000000;07000101=000000ff;07000201=404040ff;07000301=000000ff;07000401=00000000;08000101=00ff00ff;08000201=000000ff;08000301=404040ff;08000401=000000ff;09000101=00ff00ff;09000201=000000ff;09000301=404040ff;09000401=000000ff;10000101=00c000ff;10000201=000000ff;10000301=202020ff;10000401=000000ff;11000101=00ff00ff;11000201=000000ff;11000301=404040ff;11000401=000000ff;12000101=000000ff;12000201=202020ff;12000301=000000ff;12000401=00000000;13000101=000000ff;13000201=202020ff;13000301=000000ff;13000401=00000000;14000101=202020ff;14000201=000000ff;14000301=00000000;14000401=00000000;15000101=000000ff;15000201=00000000;15000301=00000000;15000401=00000000;16000101=00000000;16000201=00000000;16000301=00000000;16000401=00000000;17000101=00000000;17000201=00000000;17000301=00000000;17000401=00000000;18000101=00000000;18000201=00000000;18000301=00000000;18000401=00000000?replace;ffffffff=00000000")
	animator.setGlobalTag("cannonSprite", "?setcolor=ffffff?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=1?crop=0;0;40;16?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=00000000;03000201=00000000;03000301=00000000;03000401=00000000;03000501=00000000;03000601=000000ff;03000701=000000ff;03000801=000000ff;04000101=00000000;04000201=00000000;04000301=00000000;04000401=00000000;04000501=000000ff;04000601=000000ff;04000701=000000ff;04000801=202020ff;05000101=00000000;05000201=00000000;05000301=00000000;05000401=000000ff;05000501=202020ff;05000601=000000ff;05000701=000000ff;05000801=000000ff;06000101=00000000;06000201=00000000;06000301=000000ff;06000401=202020ff;06000501=000000ff;06000601=000000ff;06000701=00c000ff;06000801=00c000ff;07000101=00000000;07000201=00000000;07000301=000000ff;07000401=000000ff;07000501=000000ff;07000601=00c000ff;07000701=00c000ff;07000801=000000ff;08000101=00000000;08000201=000000ff;08000301=000000ff;08000401=000000ff;08000501=00c000ff;08000601=00c000ff;08000701=000000ff;08000801=404040ff;09000101=00000000;09000201=000000ff;09000301=000000ff;09000401=000000ff;09000501=008000ff;09000601=00c000ff;09000701=000000ff;09000801=202020ff;10000101=00000000;10000201=000000ff;10000301=000000ff;10000401=202020ff;10000501=000000ff;10000601=00c000ff;10000701=00c000ff;10000801=000000ff;11000101=00000000;11000201=000000ff;11000301=000000ff;11000401=000000ff;11000501=000000ff;11000601=00c000ff;11000701=00c000ff;11000801=00c000ff;12000101=00000000;12000201=000000ff;12000301=000000ff;12000401=000000ff;12000501=00c000ff;12000601=00c000ff;12000701=000000ff;12000801=000000ff;13000101=00000000;13000201=000000ff;13000301=000000ff;13000401=000000ff;13000501=00c000ff;13000601=000000ff;13000701=202020ff;13000801=202020ff;14000101=00000000;14000201=000000ff;14000301=000000ff;14000401=000000ff;14000501=008000ff;14000601=000000ff;14000701=202020ff;14000801=202020ff;15000101=00000000;15000201=000000ff;15000301=000000ff;15000401=000000ff;15000501=008000ff;15000601=000000ff;15000701=202020ff;15000801=202020ff;16000101=00000000;16000201=000000ff;16000301=000000ff;16000401=000000ff;16000501=008000ff;16000601=000000ff;16000701=202020ff;16000801=202020ff;17000101=00000000;17000201=000000ff;17000301=000000ff;17000401=202020ff;17000501=000000ff;17000601=008000ff;17000701=000000ff;17000801=202020ff;18000101=00000000;18000201=000000ff;18000301=000000ff;18000401=202020ff;18000501=202020ff;18000601=000000ff;18000701=00c000ff;18000801=000000ff;19000101=00000000;19000201=000000ff;19000301=008000ff;19000401=000000ff;19000501=202020ff;19000601=202020ff;19000701=000000ff;19000801=00c000ff;20000101=00000000;20000201=00000000;20000301=000000ff;20000401=008000ff;20000501=000000ff;20000601=202020ff;20000701=000000ff;20000801=00c000ff;21000101=00000000;21000201=00000000;21000301=000000ff;21000401=008000ff;21000501=000000ff;21000601=202020ff;21000701=000000ff;21000801=00c000ff;22000101=00000000;22000201=00000000;22000301=000000ff;22000401=008000ff;22000501=000000ff;22000601=202020ff;22000701=000000ff;22000801=00c000ff;23000101=00000000;23000201=00000000;23000301=000000ff;23000401=00c000ff;23000501=000000ff;23000601=202020ff;23000701=000000ff;23000801=00c000ff;24000101=00000000;24000201=00000000;24000301=000000ff;24000401=008000ff;24000501=000000ff;24000601=202020ff;24000701=000000ff;24000801=00c000ff;25000101=00000000;25000201=000000ff;25000301=00c000ff;25000401=000000ff;25000501=202020ff;25000601=202020ff;25000701=000000ff;25000801=00c000ff;26000101=00000000;26000201=000000ff;26000301=00c000ff;26000401=000000ff;26000501=202020ff;26000601=000000ff;26000701=008000ff;26000801=00c000ff;27000101=00000000;27000201=000000ff;27000301=000000ff;27000401=202020ff;27000501=000000ff;27000601=008000ff;27000701=000000ff;27000801=000000ff;28000101=00000000;28000201=000000ff;28000301=000000ff;28000401=000000ff;28000501=008000ff;28000601=000000ff;28000701=202020ff;28000801=202020ff;29000101=00000000;29000201=000000ff;29000301=000000ff;29000401=000000ff;29000501=000000ff;29000601=202020ff;29000701=202020ff;29000801=000000ff;30000101=00000000;30000201=000000ff;30000301=000000ff;30000401=000000ff;30000501=202020ff;30000601=202020ff;30000701=000000ff;30000801=00c000ff;31000101=00000000;31000201=000000ff;31000301=000000ff;31000401=000000ff;31000501=202020ff;31000601=000000ff;31000701=000000ff;31000801=000000ff;32000101=00000000;32000201=000000ff;32000301=000000ff;32000401=000000ff;32000501=000000ff;32000601=404040ff;32000701=404040ff;32000801=404040ff?blendmult=/objects/outpost/customsign/signplaceholder.png;0;-8?replace;01000101=00000000;01000201=00000000;01000301=00000000;01000401=00000000;01000501=00000000;01000601=00000000;01000701=00000000;01000801=00000000;02000101=00000000;02000201=00000000;02000301=00000000;02000401=00000000;02000501=00000000;02000601=00000000;02000701=00000000;02000801=00000000;03000101=000000ff;03000201=000000ff;03000301=000000ff;03000401=00000000;03000501=00000000;03000601=00000000;03000701=00000000;03000801=00000000;04000101=202020ff;04000201=202020ff;04000301=202020ff;04000401=000000ff;04000501=00000000;04000601=00000000;04000701=00000000;04000801=00000000;05000101=000000ff;05000201=000000ff;05000301=202020ff;05000401=404040ff;05000501=000000ff;05000601=00000000;05000701=00000000;05000801=00000000;06000101=00c000ff;06000201=00ff00ff;06000301=000000ff;06000401=202020ff;06000501=404040ff;06000601=000000ff;06000701=00000000;06000801=00000000;07000101=000000ff;07000201=00c000ff;07000301=00ff00ff;07000401=000000ff;07000501=404040ff;07000601=000000ff;07000701=00000000;07000801=00000000;08000101=404040ff;08000201=000000ff;08000301=00c000ff;08000401=00ff00ff;08000501=000000ff;08000601=404040ff;08000701=000000ff;08000801=00000000;09000101=404040ff;09000201=000000ff;09000301=00c000ff;09000401=00ff00ff;09000501=000000ff;09000601=404040ff;09000701=000000ff;09000801=00000000;10000101=000000ff;10000201=00c000ff;10000301=00c000ff;10000401=000000ff;10000501=202020ff;10000601=404040ff;10000701=000000ff;10000801=00000000;11000101=00c000ff;11000201=00c000ff;11000301=00ff00ff;11000401=000000ff;11000501=202020ff;11000601=404040ff;11000701=000000ff;11000801=00000000;12000101=000000ff;12000201=000000ff;12000301=00c000ff;12000401=00ff00ff;12000501=000000ff;12000601=202020ff;12000701=000000ff;12000801=00000000;13000101=404040ff;13000201=404040ff;13000301=000000ff;13000401=00ff00ff;13000501=000000ff;13000601=202020ff;13000701=000000ff;13000801=00000000;14000101=202020ff;14000201=404040ff;14000301=000000ff;14000401=00c000ff;14000501=000000ff;14000601=404040ff;14000701=000000ff;14000801=00000000;15000101=202020ff;15000201=404040ff;15000301=000000ff;15000401=00ff00ff;15000501=000000ff;15000601=404040ff;15000701=000000ff;15000801=00000000;16000101=202020ff;16000201=202020ff;16000301=000000ff;16000401=00c000ff;16000501=000000ff;16000601=202020ff;16000701=000000ff;16000801=00000000;17000101=202020ff;17000201=000000ff;17000301=00c000ff;17000401=000000ff;17000501=202020ff;17000601=404040ff;17000701=000000ff;17000801=00000000;18000101=000000ff;18000201=00c000ff;18000301=000000ff;18000401=202020ff;18000501=202020ff;18000601=000000ff;18000701=000000ff;18000801=00000000;19000101=00c000ff;19000201=000000ff;19000301=202020ff;19000401=202020ff;19000501=000000ff;19000601=00c000ff;19000701=000000ff;19000801=00000000;20000101=00c000ff;20000201=000000ff;20000301=202020ff;20000401=000000ff;20000501=00c000ff;20000601=000000ff;20000701=00000000;20000801=00000000;21000101=00c000ff;21000201=000000ff;21000301=202020ff;21000401=000000ff;21000501=00c000ff;21000601=000000ff;21000701=00000000;21000801=00000000;22000101=00ff00ff;22000201=000000ff;22000301=202020ff;22000401=000000ff;22000501=00ff00ff;22000601=000000ff;22000701=00000000;22000801=00000000;23000101=00c000ff;23000201=000000ff;23000301=202020ff;23000401=000000ff;23000501=00c000ff;23000601=000000ff;23000701=00000000;23000801=00000000;24000101=00ff00ff;24000201=000000ff;24000301=202020ff;24000401=000000ff;24000501=00ff00ff;24000601=000000ff;24000701=00000000;24000801=00000000;25000101=00ff00ff;25000201=000000ff;25000301=202020ff;25000401=404040ff;25000501=000000ff;25000601=00ff00ff;25000701=000000ff;25000801=00000000;26000101=00c000ff;26000201=00ff00ff;26000301=000000ff;26000401=404040ff;26000501=000000ff;26000601=00ff00ff;26000701=000000ff;26000801=00000000;27000101=000000ff;27000201=000000ff;27000301=00ff00ff;27000401=000000ff;27000501=404040ff;27000601=000000ff;27000701=000000ff;27000801=00000000;28000101=202020ff;28000201=202020ff;28000301=000000ff;28000401=00ff00ff;28000501=000000ff;28000601=404040ff;28000701=000000ff;28000801=00000000;29000101=000000ff;29000201=202020ff;29000301=202020ff;29000401=000000ff;29000501=000000ff;29000601=404040ff;29000701=000000ff;29000801=00000000;30000101=00ff00ff;30000201=000000ff;30000301=202020ff;30000401=202020ff;30000501=202020ff;30000601=404040ff;30000701=000000ff;30000801=00000000;31000101=000000ff;31000201=000000ff;31000301=000000ff;31000401=202020ff;31000501=202020ff;31000601=202020ff;31000701=000000ff;31000801=00000000;32000101=404040ff;32000201=404040ff;32000301=404040ff;32000401=000000ff;32000501=202020ff;32000601=000000ff;32000701=000000ff;32000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;0?replace;01000101=00000000;01000201=00000000;01000301=000000ff;01000401=000000ff;01000501=404040ff;01000601=000000ff;01000701=000000ff;01000801=000000ff;02000101=00000000;02000201=00000000;02000301=000000ff;02000401=404040ff;02000501=000000ff;02000601=404040ff;02000701=404040ff;02000801=202020ff;03000101=00000000;03000201=00000000;03000301=000000ff;03000401=404040ff;03000501=000000ff;03000601=404040ff;03000701=202020ff;03000801=404040ff;04000101=00000000;04000201=00000000;04000301=00000000;04000401=000000ff;04000501=404040ff;04000601=000000ff;04000701=000000ff;04000801=000000ff;05000101=00000000;05000201=00000000;05000301=00000000;05000401=00000000;05000501=000000ff;05000601=404040ff;05000701=404040ff;05000801=404040ff;06000101=00000000;06000201=00000000;06000301=00000000;06000401=00000000;06000501=00000000;06000601=000000ff;06000701=000000ff;06000801=000000ff;07000101=00000000;07000201=00000000;07000301=00000000;07000401=00000000;07000501=00000000;07000601=00000000;07000701=00000000;07000801=00000000;08000101=00000000;08000201=00000000;08000301=00000000;08000401=00000000;08000501=00000000;08000601=00000000;08000701=00000000;08000801=00000000?blendmult=/objects/outpost/customsign/signplaceholder.png;-32;-8?replace;01000101=000000ff;01000201=000000ff;01000301=000000ff;01000401=404040ff;01000501=000000ff;01000601=000000ff;01000701=00000000;01000801=00000000;02000101=202020ff;02000201=202020ff;02000301=000000ff;02000401=000000ff;02000501=404040ff;02000601=000000ff;02000701=00000000;02000801=00000000;03000101=202020ff;03000201=000000ff;03000301=000000ff;03000401=000000ff;03000501=404040ff;03000601=000000ff;03000701=00000000;03000801=00000000;04000101=000000ff;04000201=000000ff;04000301=000000ff;04000401=404040ff;04000501=000000ff;04000601=00000000;04000701=00000000;04000801=00000000;05000101=404040ff;05000201=404040ff;05000301=404040ff;05000401=000000ff;05000501=00000000;05000601=00000000;05000701=00000000;05000801=00000000;06000101=000000ff;06000201=000000ff;06000301=000000ff;06000401=00000000;06000501=00000000;06000601=00000000;06000701=00000000;06000801=00000000;07000101=00000000;07000201=00000000;07000301=00000000;07000401=00000000;07000501=00000000;07000601=00000000;07000701=00000000;07000801=00000000;08000101=00000000;08000201=00000000;08000301=00000000;08000401=00000000;08000501=00000000;08000601=00000000;08000701=00000000;08000801=00000000?replace;ffffffff=00000000")
end

function update(dt, fireMode, shiftHeld, controls)
	offset = {0, -0.25}
	playerPos = vectorAdd(mcontroller.position(), offset)
	angleSpread = util.toRadians(9)
	diff = world.distance(activeItem.ownerAimPosition(), playerPos)
	aimAngle = math.atan(diff[2], diff[1])

	self.primaryCooldown 	= math.max(0, self.primaryCooldown - dt)
	self.secondaryCooldown 	= math.max(0, self.secondaryCooldown - dt)
	self.tertaryCooldown 	= math.max(0, self.tertaryCooldown - dt)
	self.doubleShiftTimer 	= math.max(0, self.doubleShiftTimer - dt)
	self.puffTimer 			= math.max(0, self.puffTimer - dt)

	self.legCycle = self.legCycle + ((mcontroller.xVelocity() * 1) * -mcontroller.facingDirection())
	legRot = 0
	legRot2 = 0

	engineShake = math.sin(os.clock() * 36) / 30
	
	if mcontroller.onGround() then
		legRot = util.toRadians(self.legCycle)
		legRot2 = util.toRadians(self.legCycle + 180)
		if mcontroller.xVelocity() < 0.1 and mcontroller.xVelocity() > -0.1 then
			self.legCycle = 0
			legRot = util.toRadians(-90)
			legRot2 = util.toRadians(-90)
		end
		
	else
		self.legCycle = 0
		legRot = util.toRadians(-120 - (mcontroller.yVelocity() * 1.5))
		legRot2 = util.toRadians(-60 + (mcontroller.yVelocity() * 1.5))
	end

	activeItem.setBackArmFrame("jump.1")
	activeItem.setFrontArmFrame("walk.1")
	--tech.setParentState("sit")
	--mcontroller.setAnchorState("sit")

	self.crouchoffset = 0
	local collPoly = self.mechPoly
	if controls.down or mcontroller.isCollisionStuck() then
		self.crouchoffset = -1
		collPoly = self.mechCrouchPoly
	end
	
	mcontroller.controlModifiers({
		movementSuppressed = true, 
		facingSuppressed = false, 
		runningSuppressed = true,
		jumpingSuppressed = true,
		speedModifier = 1.6,
		groundMovementModifier = 1.4,
		airJumpModifier = 1.5
	})
	mcontroller.controlParameters({
		standingPoly = collPoly,
		gravityEnabled = true,
		jumpingSuppressed = false
	})

	activeItem.setTwoHandedGrip(true)
	updateAim()

	local walkSpeed = 9
	if shiftHeld then
		walkSpeed = 15
	end
	if mcontroller.onGround() then
		if controls.down then
			--mcontroller.setYPosition(mcontroller.yPosition() - 1)
		end
		if controls.jump then
			mcontroller.setYVelocity(35)
			animator.playSound("jump")
		end
		if controls.right and not controls.left then
			mcontroller.addMomentum({walkSpeed, 0})
		elseif controls.left and not controls.right then
			mcontroller.addMomentum({-walkSpeed, 0})
		end	

	else
		if controls.jump and mcontroller.yVelocity() > 0 then
			mcontroller.addMomentum({0, 2})
		elseif controls.down then
			mcontroller.addMomentum({0, -2})
		end
		if controls.right and not controls.left then
			mcontroller.addMomentum({0.5, 0})
		elseif controls.left and not controls.right then
			mcontroller.addMomentum({-0.5, 0})
		end
	end

	-- Remember, 0.125 is 1 pixel ingame.
	walkBob = (math.cos(legRot * 2) / 8)
	diff2 = world.distance(activeItem.ownerAimPosition(), vectorAdd(playerPos, {0, -1 + walkBob + engineShake}))
	cannonAngle = math.atan(diff2[2], diff2[1] * mcontroller.facingDirection()) * 57.2958
	if self.form == 0 then
		self.destAllRotation = 0
		self.destOffsets = {{0, 0 + walkBob + engineShake}, 
			{1 + (math.cos(legRot) * 1.5), -2 + clamp(math.sin(legRot) * 1.25, -1, 0.375) - self.crouchoffset}, 
			{-1 + (math.cos(legRot2) * 1.5), -2 + clamp(math.sin(legRot2) * 1.25, -1, 1.25) - self.crouchoffset}, 
			{1.5, -1 + walkBob + engineShake}}
		self.destRotOffsets = {{0, 0}, {0, 0}, {0, 0}, {-1.5, 0}}
		self.destRotations = {0, 0, 0, 0}
		
		self.destAllOffset 	= {-1, 0}
		self.destArmAngleOffset = 0
		activeItem.setTwoHandedGrip(true)
		activeItem.setCursor("/cursors/reticle0.cursor")
		self.transformSpeed = 0.2
		updateLayer(true)
		--updateHand(false)
		self.hide = {false, false, false}
		--activeItem.setFacingDirection(1)

	else
		self.destAllRotation = 0
		self.destOffsets = {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
		self.destRotOffsets = {{0, 0}, {0, 0}, {0, 0}, {0, 0}}
		self.destRotations = {0, 0, 0, 0}
		self.destAllOffset 	= {-1, 0}
		self.destArmAngleOffset = 0
		activeItem.setTwoHandedGrip(false)
		activeItem.setCursor("/cursors/reticle0.cursor")
		self.transformSpeed = 1
		updateHand(true)
		self.hide = {false, false, false}
	end
	self.destArmAngleOffset = self.destArmAngleOffset
	activeItem.setArmAngle(util.toRadians(0))
	
	-- For smooth animations
	for i = 1, #self.offsets, 1 do
		self.offsets[i][1] 		= lerp(self.offsets[i][1], self.destOffsets[i][1], (self.tweenTimes[i] * self.transformSpeed))
		self.offsets[i][2] 		= lerp(self.offsets[i][2], self.destOffsets[i][2], (self.tweenTimes[i] * self.transformSpeed))
		self.rotOffsets[i][1] 	= lerp(self.rotOffsets[i][1], self.destRotOffsets[i][1], (self.tweenTimes[i] * self.transformSpeed))
		self.rotOffsets[i][2] 	= lerp(self.rotOffsets[i][2], self.destRotOffsets[i][2], (self.tweenTimes[i] * self.transformSpeed))
		self.rotations[i] 		= lerp(self.rotations[i], self.destRotations[i], (self.tweenTimes[i] * self.transformSpeed))
	end
	self.allRotation 	= lerp(self.allRotation, self.destAllRotation, (self.allRotationTween * self.transformSpeed))
	self.armAngleOffset = lerp(self.armAngleOffset, self.destArmAngleOffset, (self.armAngleOffsetTween * self.transformSpeed))
	self.allOffset[1] 	= lerp(self.allOffset[1], self.destAllOffset[1], (self.allOffsetTween * self.transformSpeed))
	self.allOffset[2] 	= lerp(self.allOffset[2], self.destAllOffset[2], (self.allOffsetTween * self.transformSpeed))

	self.rotations[4] = cannonAngle

	if self.form == 0 then -- Cannon
		if (fireMode == "primary" and not self.prevPrimary) or (self.primaryCooldown == 0 and fireMode == "primary") then	
			if shiftHeld then
				self.primaryCooldown = 0.6
				cannonFire(20)
				cannonFire(20)
				cannonFire(20)
				animator.playSound("cannonAlt")
				
			else
				self.primaryCooldown = 0.3
				cannonFire(1)
				animator.playSound("cannonAlt")

			end
			
		elseif (fireMode == "alt" and not self.prevAlt) or (self.secondaryCooldown == 0 and fireMode == "alt") then	
			if shiftHeld then
				self.secondaryCooldown = 0.5
				cannonAlt(0)
				cannonAlt(15)
				cannonAlt(-15)
				
			else
				self.secondaryCooldown = 0.25
				cannonAlt(0)
				
			end
			
		else

		end

	else

	end

	if self.puffTimer == 0 then
		chimneyPuffs()
		self.puffTimer = 0.5 + (math.random(5) / 10)
	end

	self.prevShift = shiftHeld
	self.prevPrimary = (fireMode == "primary")
	self.prevAlt = (fireMode == "alt")
	self.prevControls = controls

	for i = 1, #self.offsets, 1 do
		setTransformationGroup("" .. (i - 1), self.rotations[i], 
			self.rotOffsets[i], 
			vectorAdd(self.offsets[i], vectorAdd(self.allOffset, self.baseOffset))
		)
		updateTransformationGroup("" .. (i - 1), self.allRotation, {0, 0}, {0, 0})
		if self.hide[i] then
			animator.scaleTransformationGroup("" .. (i - 1), 0)
		else
			animator.scaleTransformationGroup("" .. (i - 1), 1.0)
		end
	end
end

function uninit()
	mcontroller.controlModifiers({
		movementSuppressed = false, 
		facingSuppressed = false, 
		runningSuppressed = false,
		jumpingSuppressed = false,
		speedModifier = 1,
		groundMovementModifier = 1,
		airJumpModifier = 1
	})
	mcontroller.controlParameters({
		standingPoly = self.defaultPoly,
		gravityEnabled = true,
		jumpingSuppressed = false
	})
end

function updateLayer(alwaysFront)
	local isFrontHand = (activeItem.hand() == "primary") == (mcontroller.facingDirection() < 0)
	local isBackHand = (activeItem.hand() == "primary") == (mcontroller.facingDirection() > 0)
	animator.setGlobalTag("hand", isFrontHand and "front" or "back")

	if mcontroller.facingDirection() == 1 then
		activeItem.setOutsideOfHand(true)
	else
		activeItem.setOutsideOfHand(true)
	end
	--[[
	if alwaysFront then
		activeItem.setOutsideOfHand(isFrontHand)
	else
		activeItem.setOutsideOfHand(false)
	end
	]]
end

function chimneyPuffs()
	local thePos = {0, 0}

	if math.random(2) == 1 then
		thePos = {mcontroller.position()[1] - (1.5 * mcontroller.facingDirection()), mcontroller.position()[2] + 2.75}
		world.spawnProjectile("invisibleprojectile", thePos, activeItem.ownerEntityId(), {0, 0}, false, {
				damageType = "NoDamage",
				processing = "?multiply=00000000",
				speed = 0,
				power = 0,
				timeToLive = 0,
				piercing = true,
				bounces = -1,
				actionOnReap = {
					{
						action = "actions",
						list = {
							{
								action = "particle",
								specification = {
									type = "animated",
	    							animation = "/animations/smoke/smoke.animation?brightness=-30",
									destructionAction = "shrink",
									size = 0.5,
									destructionTime = 1,
									timeToLive = 0.8,
									initialVelocity = {0, 6},
									approach = {0, 30},
									layer = "back",
									variance = {
										angularVelocity = 0,
										position = {0, 0},
										initialVelocity = {0, 0},
										rotation = 180,
										size = 0.1
									}
								}
							}
						}
					}
				}
			}
		)

	else
		thePos = {mcontroller.position()[1] - (2.375 * mcontroller.facingDirection()), mcontroller.position()[2] + 2}
		world.spawnProjectile("invisibleprojectile", thePos, activeItem.ownerEntityId(), {0, 0}, false, {
				damageType = "NoDamage",
				processing = "?multiply=00000000",
				speed = 0,
				power = 0,
				timeToLive = 0,
				piercing = true,
				bounces = -1,
				actionOnReap = {
					{
						action = "actions",
						list = {
							{
								action = "particle",
								specification = {
									type = "animated",
	    							animation = "/animations/smoke/smoke.animation?brightness=-30",
									destructionAction = "shrink",
									size = 0.35,
									destructionTime = 1,
									timeToLive = 0.8,
									initialVelocity = {0, 4},
									approach = {0, 20},
									layer = "back",
									variance = {
										angularVelocity = 0,
										position = {0, 0},
										initialVelocity = {0, 0},
										rotation = 180,
										size = 0.1
									}
								}
							}
						}
					}
				}
			}
		)
	end
end


function cannonFire(spread)
	angleSpread = util.toRadians(spread - (math.random(spread * 20) / 10))
	local theOffset = vectorAdd(playerPos, {0, -1.25})
	local theAngle = util.toRadians(cannonAngle)
	theOffset = vectorAdd(theOffset, {(math.cos(theAngle) * 3.25) * mcontroller.facingDirection(), math.sin(theAngle) * 3.25})

	world.spawnProjectile("invisibleprojectile", theOffset, activeItem.ownerEntityId(), 
		{math.cos(theAngle + angleSpread) * mcontroller.facingDirection(), math.sin(theAngle + angleSpread)}, false, {
			damageType = "NoDamage",
			processing = "?multiply=00000000",
			speed = 0,
			power = 0,
			timeToLive = 0,
			piercing = true,
			bounces = -1,
			actionOnReap = {
				{
					action = "actions",
					list = {
						{
							action = "light",
							color = "green"
						},
						{
							action = "particle",
							specification = {
								type = "textured",
								fullbright = true,
								light = {0, 50, 0},
								destructionAction = "shrink",
								layer = "front",
								size = 3,
								destructionTime = 0.25,
								layer = "front",
								image = "/celestial/stars/star17pxRed.png:" .. math.random(3) .. "?hueshift=-30?hueshift=180",
								variance = {
									angularVelocity = 180,
									rotation = 180
								}
							}
						}
					}
				}
			}
		}
	)

	world.spawnProjectile("homingrocket", theOffset, 
		activeItem.ownerEntityId(), {math.cos(theAngle + angleSpread) * mcontroller.facingDirection(), 
		math.sin(theAngle + angleSpread)}, false, {
			processing = "?saturation=00?hueshift=-120?scalenearest=2",
			speed = 40,
			power = 30,
			timeToLive = 3,
			knockback = 10,
			controlForce = 300,
  			maxSpeed = 150,
			piercing = false,
  			knockbackDirectional = true,
			physics = "grenade",
			damageType = "IgnoresDef", 
			damageTeam = {type = "pvp"},
			damageKind = "default",
			scripts = { "homingrocket.lua" },
  			statusEffects = {{effect = "fuparalysis", duration = 1}, "lowgrav", "lowgravaugment", "stafflowgrav"},
			periodicActions = {
				{
					time = 0,
					action = "actions",
					list = {
						{
							action = "light",
							color = "#008800"
						}
					}
				},
				{
					time = 0.025,
					action = "particle",
					specification = {
						type = "textured",
						fullbright = true,
						light = {0, 50, 0},
						destructionAction = "shrink",
						position = {0, 0},
						size = 1,
						destructionTime = 0.35,
						layer = "front",
						image = "/celestial/system/red_sun.png?scalenearest=0.1?saturation=100?hueshift=120",
						variance = {
							angularVelocity = 180,
							position = {0.125, 0.125},
							rotation = 180
						}
					}
				}
			},
			actionOnReap = {
				{
					action = "actions",
					list = {
						{
							action = "projectile",
							inheritDamageFactor = 1,
							type = "rocketexplosion",
							stop = true,
							config = {
								processing = "?multiply=00DD00FF"
							}
						},
						{
							action = "loop",
							count = 10,
							body = {
								{
									action = "option",
									options = {
										{
											action = "particle",
											specification = {
												type = "animated",
												animation = "/animations/dusttest/dusttest.animation?multiply=00BB00FF",
												approach = {0.5, 0.5},
												timeToLive = 0.85,
												variance = {
													position = {1.5, 1.5},
													initialVelocity = {1, 1},
													rotation = 180
												}
											}
										}
									}
								},
								{
									action = "spark"
								}
							}
						},
						{
							action = "sound",
							options = { "/sfx/gun/rocketblast1.ogg", "/sfx/gun/rocketblast2.ogg", "/sfx/gun/rocketblast3.ogg" }
						},
						{
							action = "light",
							color = "green"
						},
						{
							action = "explosion",
							foregroundRadius = 4,
							backgroundRadius = 3,
							explosiveDamageAmount = 0.5,
							delaySteps = 2
						}
					}
				},
				{
					action = "particle",
					specification = {
						type = "textured",
						fullbright = true,
						light = {0, 150, 0},
						destructionAction = "shrink",
						position = {0, 0},
						size = 0.5,
						destructionTime = 0.65,
						layer = "front",
						image = "/celestial/system/red_sun.png?scalenearest=0.8?saturation=100?hueshift=120",
						variance = {
							angularVelocity = 180,
							position = {0.125, 0.125},
							rotation = 180
						}
					}
				}
			}
		}
	)
end

function cannonAlt(angle)
	angleSpread = util.toRadians(angle)
	local theOffset = vectorAdd(playerPos, {0, -1.25})
	local theAngle = util.toRadians(cannonAngle)
	theOffset = vectorAdd(theOffset, {(math.cos(theAngle) * 3.25) * mcontroller.facingDirection(), math.sin(theAngle) * 3.25})

	world.spawnProjectile("invisibleprojectile", theOffset, activeItem.ownerEntityId(), 
		{math.cos(theAngle + angleSpread) * mcontroller.facingDirection(), math.sin(theAngle + angleSpread)}, false, {
			damageType = "NoDamage",
			processing = "?multiply=00000000",
			speed = 0,
			power = 0,
			timeToLive = 0,
			piercing = true,
			bounces = -1,
			actionOnReap = {
				{
					action = "actions",
					list = {
						{
							action = "light",
							color = "green"
						},
						{
							action = "particle",
							specification = {
								type = "textured",
								fullbright = true,
								light = {0, 50, 0},
								destructionAction = "shrink",
								layer = "front",
								size = 5,
								destructionTime = 0.3,
								layer = "front",
								image = "/celestial/stars/star17pxRed.png:" .. math.random(3) .. "?hueshift=-30?hueshift=180",
								variance = {
									angularVelocity = 180,
									rotation = 180
								}
							}
						}
					}
				}
			}
		}
	)

	world.spawnProjectile("standardbullet", theOffset, activeItem.ownerEntityId(), 
		{math.cos(theAngle + angleSpread) * mcontroller.facingDirection(), math.sin(theAngle + angleSpread)}, false, {
			movementSettings = {
				maxMovementPerStep = 0.4,
				liquidFriction = 0,
				airFriction = 0,
				collisionPoly = {
					{-0.25, -0.25},
					{0.25, -0.25},
					{0.25, 0.25},
					{-0.25, 0.25}
				},
				groundFriction = 0,
				ignorePlatformCollision = true,
				gravityMultiplier = 0.1,
				groundSlideMovementEnabled = false,
				bounceFactor = 0.945
			},
			piercing = true,
			processing = "?multiply=00000000",
			speed = 120,
			image = "/assetMissing.png",
			lightColor = {0, 100, 0},
			bounces = -1,
			power = 20,
			periodicActions = {
				{
					time = 0,
					action = "particle",
					specification = {
						position = {0, 0},
						layer = "back",
						timeToLive = 0.06,
						destructionAction = "fade",
						fullbright = true,
						type = "textured",
						statusEffects = {{
							duration = 1,
							effect = "burning"
						}},
						destructionTime = 0.2,
						image = "/assetMissing.png?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=1?crop=0;0;32;3?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=FFFFFF00;01000201=FFB20AFF;01000301=FFFFFF00;02000101=FFFFFF00;02000201=FFB20AFF;02000301=FFFFFF00;03000101=FFFFFF00;03000201=FFB20AFF;03000301=FFFFFF00;04000101=FFFFFF00;04000201=FFB20AFF;04000301=FFFFFF00;05000101=FFFFFF00;05000201=FFB20AFF;05000301=FFFFFF00;06000101=FFFFFF00;06000201=FFB20AFF;06000301=FFFFFF00;07000101=FFFFFF00;07000201=FFB20AFF;07000301=FFFFFF00;08000101=FFFFFF00;08000201=FFB20AFF;08000301=FFFFFF00;09000101=FFFFFF00;09000201=FFB20AFF;09000301=FFFFFF00;10000101=FFFFFF00;10000201=FFB20AFF;10000301=FFFFFF00;11000101=FFFFFF00;11000201=FFB20AFF;11000301=FFFFFF00;12000101=FFFFFF00;12000201=FFB20AFF;12000301=FFFFFF00;13000101=FFFFFF00;13000201=FFB20AFF;13000301=FFFFFF00;14000101=FFFFFF00;14000201=FFB20AFF;14000301=FFFFFF00;15000101=FFFFFF00;15000201=FFB20AFF;15000301=FFFFFF00;16000101=FFFFFF00;16000201=FFB20AFF;16000301=FFFFFF00;17000101=FFB20AFF;17000201=FFCF68FF;17000301=FFB20AFF;18000101=FFB20AFF;18000201=FFCF68FF;18000301=FFB20AFF;19000101=FFB20AFF;19000201=FFCF68FF;19000301=FFB20AFF;20000101=FFB20AFF;20000201=FFCF68FF;20000301=FFB20AFF;21000101=FFB20AFF;21000201=FFCF68FF;21000301=FFB20AFF;22000101=FFB20AFF;22000201=FFCF68FF;22000301=FFB20AFF;23000101=FFB20AFF;23000201=FFCF68FF;23000301=FFB20AFF;24000101=FFB20AFF;24000201=FFCF68FF;24000301=FFB20AFF;25000101=FFB20AFF;25000201=FFCF68FF;25000301=FFB20AFF;26000101=FFB20AFF;26000201=FFCF68FF;26000301=FFB20AFF;27000101=FFB20AFF;27000201=FFCF68FF;27000301=FFB20AFF;28000101=FFB20AFF;28000201=FFCF68FF;28000301=FFB20AFF;29000101=FFB20AFF;29000201=FFCF68FF;29000301=FFB20AFF;30000101=FFB20AFF;30000201=FFCF68FF;30000301=FFB20AFF;31000101=FFB20AFF;31000201=FFCF68FF;31000301=FFB20AFF;32000101=FFB20AFF;32000201=FFCF68FF;32000301=FFB20AFF?replace;FFFFFFFF=FFFFFF00?hueshift=110?scalenearest;1;2.15;" .. "?hueshift=-40"
					},
					rotate = true
				}, 
				{
					time = 0,
					action = "particle",
					specification = {
						position = {0, 0},
						layer = "back",
						timeToLive = 0.03,
						destructionAction = "fade",
						fullbright = true,
						type = "textured",
						statusEffects = {{
							duration = 1,
							effect = "burning"
						}},
						destructionTime = 0.1,
						image = "/assetMissing.png?replace;00000000=ffffff;ffffff00=ffffff?setcolor=ffffff?scalenearest=1?crop=0;0;32;3?blendmult=/objects/outpost/customsign/signplaceholder.png;0;0?replace;01000101=FFCF68FF;01000201=FEFEFEFF;01000301=FFCF68FF;02000101=FFCF68FF;02000201=FEFEFEFF;02000301=FFCF68FF;03000101=FFCF68FF;03000201=FEFEFEFF;03000301=FFCF68FF;04000101=FFCF68FF;04000201=FEFEFEFF;04000301=FFCF68FF;05000101=FFCF68FF;05000201=FEFEFEFF;05000301=FFCF68FF;06000101=FFCF68FF;06000201=FEFEFEFF;06000301=FFCF68FF;07000101=FFCF68FF;07000201=FEFEFEFF;07000301=FFCF68FF;08000101=FFCF68FF;08000201=FEFEFEFF;08000301=FFCF68FF;09000101=FFCF68FF;09000201=FEFEFEFF;09000301=FFCF68FF;10000101=FFCF68FF;10000201=FEFEFEFF;10000301=FFCF68FF;11000101=FFCF68FF;11000201=FEFEFEFF;11000301=FFCF68FF;12000101=FFCF68FF;12000201=FEFEFEFF;12000301=FFCF68FF;13000101=FFCF68FF;13000201=FEFEFEFF;13000301=FFCF68FF;14000101=FFCF68FF;14000201=FEFEFEFF;14000301=FFCF68FF;15000101=FFCF68FF;15000201=FEFEFEFF;15000301=FFCF68FF;16000101=FFCF68FF;16000201=FEFEFEFF;16000301=FFCF68FF;17000101=FFCF68FF;17000201=FEFEFEFF;17000301=FFCF68FF;18000101=FFCF68FF;18000201=FEFEFEFF;18000301=FFCF68FF;19000101=FFCF68FF;19000201=FEFEFEFF;19000301=FFCF68FF;20000101=FFCF68FF;20000201=FEFEFEFF;20000301=FFCF68FF;21000101=FFCF68FF;21000201=FEFEFEFF;21000301=FFCF68FF;22000101=FFCF68FF;22000201=FEFEFEFF;22000301=FFCF68FF;23000101=FFCF68FF;23000201=FEFEFEFF;23000301=FFCF68FF;24000101=FFCF68FF;24000201=FEFEFEFF;24000301=FFCF68FF;25000101=FFCF68FF;25000201=FEFEFEFF;25000301=FFCF68FF;26000101=FFCF68FF;26000201=FEFEFEFF;26000301=FFCF68FF;27000101=FFCF68FF;27000201=FEFEFEFF;27000301=FFCF68FF;28000101=FFCF68FF;28000201=FEFEFEFF;28000301=FFCF68FF;29000101=FFCF68FF;29000201=FEFEFEFF;29000301=FFCF68FF;30000101=FFCF68FF;30000201=FEFEFEFF;30000301=FFCF68FF;31000101=FFCF68FF;31000201=FEFEFEFF;31000301=FFCF68FF;32000101=FFCF68FF;32000201=FEFEFEFF;32000301=FFCF68FF?replace;FFFFFFFF=FFFFFF00?hueshift=110?scalenearest;1;2.15;" .. "?hueshift=-40"
					},
					rotate = true
				},
				{
					time = 0,
					action = "light",
					color = "#00bb00"
				}
			},
			actionOnReap = {
				{
					action = "actions",
					list = {
						{
							action = "sound",
							options = { "/sfx/gun/rocketblast1.ogg", "/sfx/gun/rocketblast2.ogg", "/sfx/gun/rocketblast3.ogg" }
						},
						{
							action = "light",
							color = "green"
						}
					}
				},
				{
					action = "particle",
					specification = {
						type = "textured",
						fullbright = true,
						light = {0, 150, 0},
						destructionAction = "shrink",
						position = {0, 0},
						size = 0.5,
						destructionTime = 0.65,
						layer = "front",
						image = "/celestial/system/red_sun.png?scalenearest=0.8?saturation=100?hueshift=120",
						variance = {
							angularVelocity = 180,
							position = {0.125, 0.125},
							rotation = 180
						}
					}
				}
			},
			actionOnCollide = {
				{
					action = "sound",
					options = { "/sfx/gun/rocketblast1.ogg", "/sfx/gun/rocketblast2.ogg", "/sfx/gun/rocketblast3.ogg" }
				},
				{
					action = "particle",
					specification = {
						type = "textured",
						fullbright = true,
						light = {0, 50, 0},
						destructionAction = "shrink",
						position = {0, 0},
						size = 0.35,
						destructionTime = 0.3,
						layer = "front",
						image = "/celestial/system/red_sun.png?scalenearest=0.8?saturation=100?hueshift=120",
						variance = {
							angularVelocity = 180,
							position = {0.125, 0.125},
							rotation = 180
						}
					}
				}
			},
			timeToLive = 1.5,
			damageType = "IgnoresDef"
		}
	)
end